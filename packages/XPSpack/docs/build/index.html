<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · XPSpack</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>XPSpack</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/main/packages/XPSpack/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="XPSpack"><a class="docs-heading-anchor" href="#XPSpack">XPSpack</a><a id="XPSpack-1"></a><a class="docs-heading-anchor-permalink" href="#XPSpack" title="Permalink"></a></h1><p>Documentation for XPSpack</p><article class="docstring"><header><a class="docstring-binding" id="XPSpack.XPSpack" href="#XPSpack.XPSpack"><code>XPSpack.XPSpack</code></a> — <span class="docstring-category">Module</span></header><section><div><p>This is the <a href="#XPSpack.XPSpack"><code>XPSpack</code></a>, which contains</p><ul><li><a href="#XPSpack.σ_bg"><code>XPSpack.σ_bg</code></a></li><li><a href="#XPSpack.σ_bg_density"><code>XPSpack.σ_bg_density</code></a></li><li><a href="#XPSpack.fingerGeom"><code>XPSpack.fingerGeom</code></a></li><li><a href="#XPSpack.planeGeom"><code>XPSpack.planeGeom</code></a></li><li><a href="#XPSpack.cylinderGeom"><code>XPSpack.cylinderGeom</code></a></li><li><a href="#XPSpack.d_plane_P"><code>XPSpack.d_plane_P</code></a></li><li><a href="#XPSpack.d_cylinder_P"><code>XPSpack.d_cylinder_P</code></a></li><li><a href="#XPSpack.d_cylinder_P_simple"><code>XPSpack.d_cylinder_P_simple</code></a></li><li><a href="#XPSpack.d_sphere_P"><code>XPSpack.d_sphere_P</code></a></li><li><a href="#XPSpack.plane_gain_H"><code>XPSpack.plane_gain_H</code></a></li><li><a href="#XPSpack.finger_gain_H"><code>XPSpack.finger_gain_H</code></a></li><li><a href="#XPSpack.cylinder_gain_H"><code>XPSpack.cylinder_gain_H</code></a></li><li><a href="#XPSpack.sphere_gain_H"><code>XPSpack.sphere_gain_H</code></a></li><li><a href="#XPSpack.beamProfile"><code>XPSpack.beamProfile</code></a></li><li><a href="#XPSpack.alignmentParameter"><code>XPSpack.alignmentParameter</code></a></li><li><a href="#XPSpack.alignmentParameterSphere"><code>XPSpack.alignmentParameterSphere</code></a></li><li><a href="#XPSpack.cov_H_cylinder"><code>XPSpack.cov_H_cylinder</code></a></li><li><a href="#XPSpack.baseline_removal"><code>XPSpack.baseline_removal</code></a></li><li><a href="#XPSpack.EM_peaks"><code>XPSpack.EM_peaks</code></a></li><li><a href="#XPSpack.cross_section_spread_function"><code>XPSpack.cross_section_spread_function</code></a></li><li><a href="#XPSpack.cross_section_spread_function_sample"><code>XPSpack.cross_section_spread_function_sample</code></a></li><li><a href="#XPSpack.noiseAndParameterEstimation"><code>XPSpack.noiseAndParameterEstimation</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSpack.jl#L6-L30">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.σ_bg" href="#XPSpack.σ_bg"><code>XPSpack.σ_bg</code></a> — <span class="docstring-category">Function</span></header><section><div><p>σ_bg(Ke::Cdouble)</p><p>simulated total cross section of the background of an acquisition involving inelastic electron interaction    Ke is the kinetic energy of the incoming eletron</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/cross_section.jl#L64-L69">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.σ_bg_density" href="#XPSpack.σ_bg_density"><code>XPSpack.σ_bg_density</code></a> — <span class="docstring-category">Function</span></header><section><div><p>σ<em>bg</em>density(Ke::Array{Cdouble,1},Ke_cutoff::Cdouble,ΔKe::Cdouble)    spectral density of the simulated cross section of the background of an acquisition involving inelastic electron interaction    Ke is the kinetic energy of the (secondary) (re)emitted eletron</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/cross_section.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.fingerGeom" href="#XPSpack.fingerGeom"><code>XPSpack.fingerGeom</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">fingerGeom is a mutable structure that contains the necessary parameters to describe a 1D geometry 
where some signal may come from, hence the name finger.

- x0,y0,z0: location of the analyzer&#39;s apperture
- x,y:      coordinate of the electron source at the surface of the planar sample
- z:        array of depth into the sample

fingerGeom(x0_::Cdouble,y0_::Cdouble,z0_::Cdouble,x_::Cdouble,y_::Cdouble,z_::Array{Cdouble,1})
creates an object of type fingerGeom</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L44-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.planeGeom" href="#XPSpack.planeGeom"><code>XPSpack.planeGeom</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">planeGeom is a mutable structure that contains the necessary parameters to describe a 3D geometry 
where some signal may come from (some cuboid volume underneath the surface of a planar sample)

- x0,y0,z0: location of the analyzer&#39;s apperture
- x,y:      coordinates of the electron source at the surface of the planar sample
- z:        array of depth into the sample

planeGeom(x0_::Cdouble,y0_::Cdouble,z0_::Cdouble,x_::Array{Cdouble,1},y_::Array{Cdouble,1},z_::Array{Cdouble,1})
creates an object of type planeGeom</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L80-L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.cylinderGeom" href="#XPSpack.cylinderGeom"><code>XPSpack.cylinderGeom</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">cylinderGeom is a mutable structure that contains the necessary parameters to describe a 3D geometry 
where some signal may come from (some cuboid volume underneath the surface of a planar sample)

- x0,y0,z0: location of the analyzer&#39;s apperture (Cartesian coordinate)
- μ0:       radius of the liquid microjet
- θ,y:      coordinates of the electron source at the surface of the cylindrical sample (cylindrical coordinates)
- r:        array of depth into the sample (radius in the sample)

cylinderGeom(x0_::Cdouble,y0_::Cdouble,z0_::Cdouble,μ0_::Cdouble,r_::Array{Cdouble,1},θ_::Array{Cdouble,1},y_::Array{Cdouble,1})
creates an object of type planeGeom</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L116-L127">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.d_plane_P" href="#XPSpack.d_plane_P"><code>XPSpack.d_plane_P</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">d_plane_P(x::Cdouble,y::Cdouble,z::Array{Cdouble,1},x0::Cdouble,y0::Cdouble,z0::Cdouble)

In the planar geometry, e.g. flat surface spinning wheel, this function returns the distance
from any point M:(x,y,z) in the sample to the surface in direction to some point P:(x0,y0,z0).
Note that the planar interface is z=0 and that the sample sits in the volume z⩽0. Also, the
distances are computed for fixed x and y.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L213-L220">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.d_cylinder_P" href="#XPSpack.d_cylinder_P"><code>XPSpack.d_cylinder_P</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">d_cylinder_P(r::Array{Cdouble,1},θ::Array{Cdouble,1},y::Cdouble,x0::Cdouble,y0::Cdouble,z0::Cdouble,μ0::Cdouble)

In the cylindrical geometry, e.g. microjet, this function computes the distance from any
point M:(r,θ,y) in the sample to the surface in direction to some point P:(x0,y0,z0).
Note: M is given in cylindrical coordinates and P in Cartesian coordinates.
Note: the mapping is computed only for one slice at y.

The geometry of the sample is so that Oy is the symmetry axis (along the liquid stream direction),
Oz is along the photon beam and Ox is the remaining axis in the orthogonal basis.
θ is taken between Oz and the project of M onto the plane xOz and r = √(x^2+z^2)
μ0 is the radius of the cylinder</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L228-L241">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.d_cylinder_P_simple" href="#XPSpack.d_cylinder_P_simple"><code>XPSpack.d_cylinder_P_simple</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">d_cylinder_P_simple(r::Array{Cdouble,1},θ::Array{Cdouble,1},y::Cdouble,x0::Cdouble,y0::Cdouble,z0::Cdouble,μ0::Cdouble)

Simplification of d_cylinder_P in the case μ0≪√((x0-x)^2+(z0-z)^2) and  |y0-y|≪√((x0-x)^2+(z0-z)^2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L254-L258">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.d_sphere_P" href="#XPSpack.d_sphere_P"><code>XPSpack.d_sphere_P</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">d_sphere_P(r::Array{Cdouble,1},θ::Array{Cdouble,1},φ::Array{Cdouble,1},x0::Cdouble,y0::Cdouble,z0::Cdouble,μ0::Cdouble)

In the spherical geometry, e.g. droplet, this function computes the distance from any
point M:(r,θ,φ) in the sample to the surface in direction to some point P:(x0,y0,z0).
Note: M is given in spherical coordinates and P in Cartesian coordinates.

The geometry of the sample is so that Oz is the symmetry axis (along the droplet stream direction),
Ox is along the photon beam and Oy is the remaining axis in the orthogonal basis.
θ is taken between Ox and the projection of M onto the plane xOy, φ between M and Oz, and r = √(x^2+y^2+z^2)
μ0 is the radius of the cylinder</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L270-L281">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.plane_gain_H" href="#XPSpack.plane_gain_H"><code>XPSpack.plane_gain_H</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">plane_gain_H(x::Array{Cdouble,1},y::Array{Cdouble,1},z::Array{Cdouble,1},x0::Cdouble,y0::Cdouble,z0::Cdouble,λe::Cdouble)

Compute the volume integrales (exact for piecewise linear gain)

H_{n,j,k} = ∭ e_n(z)e_j(x)e_k(y) e^{-d_P(M)/λe} dzdxdy

The arrays x, y and z are the discretization subdivisions
P:(x0,y0,z0) is the point in Cartesian coordinates used for the computation of the distance d_P
λe is the attenuation length in the Beer-Lambert model

Note: does not include the profile of the beam light, but it can be add easily if known</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L394-L406">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.finger_gain_H" href="#XPSpack.finger_gain_H"><code>XPSpack.finger_gain_H</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">finger_gain_H(x::Cdouble,y::Cdouble,z::Array{Cdouble,1},x0::Cdouble,y0::Cdouble,z0::Cdouble,λe::Cdouble)

Compute the volume integrales (exact for piecewise linear gain)

H_{n} = ∫ e_n(z) e^{z/λe} dz

The array z is the discretization subdivisions, and (x,y) is the coordinate at the sample&#39;s surface
where the model is evaluated.
P:(x0,y0,z0) is the point in Cartesian coordinates used for the computation of the distance d_P
λe is the attenuation length in the Beer-Lambert model

Note: this model should be used only if not enough information is known about the experiment&#39;s geometry. It assumes
that the whole signal is coming from one line orthogonal to the sample&#39;s surface, thus ignoring the variation in
the distance the electron has to travel though the sample due to the surfacic spread of the illumination,
making this model less surface sensitive.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L430-L446">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.cylinder_gain_H" href="#XPSpack.cylinder_gain_H"><code>XPSpack.cylinder_gain_H</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cylinder_gain_H(r::Array{Cdouble,1},θ::Array{Cdouble,1},y::Array{Cdouble,1},x0::Cdouble,y0::Cdouble,z0::Cdouble,μ0::Cdouble,λe::Cdouble)

Compute the volume integrales (exact for piecewise linear gain)

H_{n,j,k} = ∭ e_n(r)e_j(θ)e_k(y) e^{-d_P(M)/λe} rdrdθdy

The arrays r, θ and y are the discretization subdivisions
P:(x0,y0,z0) is the point in Cartesian coordinates used for the computation of the distance d_P
μ0 is the radius of the cylinder
λe is the attenuation length in the Beer-Lambert model

Note: does not include the profile of the beam light, 
but it can be add easily if known, see alignmentParameter</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L456-L470">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.sphere_gain_H" href="#XPSpack.sphere_gain_H"><code>XPSpack.sphere_gain_H</code></a> — <span class="docstring-category">Function</span></header><section><div><p>sphere<em>gain</em>H(r::Array{Cdouble,1},θ::Array{Cdouble,1},φ::Array{Cdouble,1},x0::Cdouble,y0::Cdouble,z0::Cdouble,μ0::Cdouble,λe::Cdouble)</p><pre><code class="nohighlight hljs">Compute the volume integrales (exact for piecewise linear gain)

H_{n,j,k} = ∭ e_n(r)e_j(θ)e_k(φ) e^{-d_P(M)/λe} r^2sin(φ)drdφdθ

The geometry of the sample is so that Oz is the symmetry axis (along the droplet stream direction),
Ox is along the photon beam and Oy is the remaining axis in the orthogonal basis.

The arrays r, φ and θ are the discretization subdivisions (r: radial distance, φ polar angle, and θ azimuthal angle).
The polar axis is Oz, φ is the polar angle between M and Oz, θ is taken between Ox and the projection of M onto the plane xOy, and r = √(x^2+y^2+z^2)

P:(x0,y0,z0) is the point in Cartesian coordinates used for the computation of the distance d_P
μ0 is the radius of the sphere
λe is the attenuation length in the Beer-Lambert model

Note: does not include the profile of the beam light, 
but it can be add easily if known, see alignmentParameterSphere</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L490-L509">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.beamProfile" href="#XPSpack.beamProfile"><code>XPSpack.beamProfile</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">beamProfile: structure describing the extent of the spread in space of the photon beam
The beam density is taken to be a cross section of the parallel beam (orthogonal to the propagation direction)
(xc,yc): coordinate of the center
(σx,σy): spatial spread in x and y directions</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L536-L541">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.alignmentParameter" href="#XPSpack.alignmentParameter"><code>XPSpack.alignmentParameter</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alignmentParameter(bp::beamProfile,r::Array{Cdouble,1},θ::Array{Cdouble,1},y::Array{Cdouble,1},x0::Cdouble,y0::Cdouble,z0::Cdouble,μ0::Cdouble,λe::Cdouble)

Compute the volume integrales (exact for piecewise linear gain)

H_{n,j,k} = ∭ e_n(r)e_j(θ)e_k(y) f_beam(r,θ,y) e^{-d_P(M)/λe} rdrdθdy
H_{n,j,k} = ∭ e_n(r)e_j(θ)e_k(y) e^{-d_P(M)/λe} rdrdθdy

The arrays r, θ and y are the discretization subdivisions
P:(x0,y0,z0) is the point in Cartesian coordinates used for the computation of the distance d_P
μ0 is the radius of the cylinder
λe is the attenuation length in the Beer-Lambert model
bp: a beam profile object that describes the deviation from the center of the target and the spatial spread of the beam

Note: does not include the profile of the beam light, 
but it can be add easily if known, see alignmentParameter</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L562-L578">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.alignmentParameterSphere" href="#XPSpack.alignmentParameterSphere"><code>XPSpack.alignmentParameterSphere</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alignmentParameterSphere(bp::beamProfile,r::Array{Cdouble,1},φ::Array{Cdouble,1},θ::Array{Cdouble,1},x0::Cdouble,y0::Cdouble,z0::Cdouble,μ0::Cdouble,λe::Cdouble)

Compute the volume integrales (exact for piecewise linear gain)

H_{n,j,k} = ∭ e_n(r)e_j(φ)e_k(θ) f_beam(r,θ,y) e^{-d_P(M)/λe} r^2sin(φ)drdφdθ
H_{n,j,k} = ∭ e_n(r)e_j(φ)e_k(θ) e^{-d_P(M)/λe} r^2sin(φ)drdφdθ

The geometry of the sample is so that Oy is the symmetry axis (along the droplet stream direction),
Oz is along the photon beam and Ox is the remaining axis in the orthogonal basis.

The arrays r, φ and θ are the discretization subdivisions (r: radial distance, φ polar angle, and θ azimuthal angle).
The polar axis is Oy, φ is the polar angle between M and Oy, θ is taken between Oz and the project of M onto the plane xOz, and r = √(x^2+y^2+z^2)

P:(x0,y0,z0) is the point in Cartesian coordinates used for the computation of the distance d_P
μ0 is the radius of the cylinder
λe is the attenuation length in the Beer-Lambert model
bp: a beam profile object that describes the deviation from the center of the target and the spatial spread of the beam

Note: does not include the profile of the beam light, 
but it can be add easily if known, see alignmentParameterSphere</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L606-L627">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.cov_H_cylinder" href="#XPSpack.cov_H_cylinder"><code>XPSpack.cov_H_cylinder</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cov_H_cylinder()

computes the covariance matrix of the geometrical structure...
A = ∭ ρ(r,θ,y) e^{\frac{d_P(r,θ,y)}{λ}} r dr dθ dy ≃ Hρ
where H = [H_1 H_2 … H_Nr]† and 
H_n(λ) = r_n ∑_j ∑_k e^{\frac{d_P(r_n,θ_j,y_k)}{λ}} ∭ e_n(r) e_j(θ) e_k(y) dr dθ dy
ΓH = cov(H) = \mathbb{E} [H×H†] - \mathbb{E}[H]×\mathbb{E} [H†]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSmeas.jl#L694-L702">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.baseline_removal" href="#XPSpack.baseline_removal"><code>XPSpack.baseline_removal</code></a> — <span class="docstring-category">Function</span></header><section><div><p>baseline correction from Baek 2015 (it&#39;s an application of IRLS)    Baek SJ, Park A, Ahn YJ, Choo J. Baseline correction using asymmetrically reweighted penalized least squares smoothing. Analyst. 2015;140(1):250-7.</p><p>y: raw spectra (as in still with the baseline)</p><p>λ: regularization parameter (so far, for my cases, 1.0e5 was looking good)</p><p>κ: the asymmetry parameter p is recommended to set between 0.001 and 0.1</p><p>D: the second order difference matrix (or any orther regularization matrix)</p><p>Nmax: max number of iterations</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSutils.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.EM_peaks" href="#XPSpack.EM_peaks"><code>XPSpack.EM_peaks</code></a> — <span class="docstring-category">Function</span></header><section><div><p>X: samples from the probability distribution to be fitted with M (=length(τm)) modes    τm:  the inital probability of a point of the spectra to belong to one of the different peaks    μm:  initial mean of the peaks (the modes)    σm:  initial standard deviation of the peaks (width of the modes)    Nt:  number of iterations for the EM algorithm (se Dempster 77)    Dempster AP, Laird NM, Rubin DB. Maximum likelihood from incomplete data via the EM algorithm. Journal of the Royal Statistical Society: Series B (Methodological). 1977 Sep;39(1):1-22</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSutils.jl#L49-L56">source</a></section><section><div><p>Bes: binding energy (one for each point of the spectra) PES: the spectra τm:  the inital probability of a point of the spectra to belong to one of the different peaks μm:  initial mean of the peaks (the modes) σm:  initial standard deviation of the peaks (width of the modes) Ns:  number of sample per point in the spectra</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSutils.jl#L84-L90">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.cross_section_spread_function" href="#XPSpack.cross_section_spread_function"><code>XPSpack.cross_section_spread_function</code></a> — <span class="docstring-category">Function</span></header><section><div><p>I<em>nbl:    photo-electric signal (corrected for the baseline)    Kes:      kinetic energy discretization points (regularly sub division)    σ</em>I:      noise level in the measurement (standard deviation)    Nbfgs:    number of iterations in the bounded BFGS loop    Nsearch:  maximum number of iteration for the line search    σ_2nd:    regularization parameter, amplitutde of the second order difference (standard deviation)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSutils.jl#L113-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.cross_section_spread_function_sample" href="#XPSpack.cross_section_spread_function_sample"><code>XPSpack.cross_section_spread_function_sample</code></a> — <span class="docstring-category">Function</span></header><section><div><p>I<em>nbl:    photo-electric signal (corrected for the baseline) Kes:      kinetic energy discretization points (regularly sub division) σ</em>I:      noise level in the measurement (standard deviation) Nbfgs:    number of iterations in the bounded BFGS loop Nsearch:  maximum number of iteration for the line search N<em>sample: number of samples (model R) σ</em>2nd:    regularization parameter, amplitutde of the second order difference (standard deviation)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSutils.jl#L172-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="XPSpack.noiseAndParameterEstimation" href="#XPSpack.noiseAndParameterEstimation"><code>XPSpack.noiseAndParameterEstimation</code></a> — <span class="docstring-category">Function</span></header><section><div><p>noiseAndParameterEstimation(σ<em>χ::Array{Cdouble,1},H::Array{Cdouble,1},I</em>data::Array{Cdouble,1},I_bg::Array{Cdouble,1},ρ::Array{Cdouble,1})</p><p>returns the mean estimate of the multiplicative factor in the measurement model (including the alignment factor) and the samples τ_{ℓ,k} used to compute the mean    and an estimate of the noise perturbations.</p><p>σ<em>χ is the cross section density    H is the geometrical factor    I</em>data is the raw data (including the background)    I_bg is the background    ρ is a rough profile (potentially the bulk concentration in the volume and 0 outside)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/Center-for-Atmospheric-Research-ATMOS/XPS-depth-inv/blob/b8e21586fd352ca612fd8f6d4f35e9993b914d17/packages/XPSpack/src/XPSutils.jl#L249-L260">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Wednesday 3 May 2023 21:45">Wednesday 3 May 2023</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
